# Electronic Magnifier

Экранная лупа для Windows 10/11, соответствующая требованиям из `product-requirements-magnifier.ru.md`.

## Возможности
- Полноэкранное окно лупы на выделенном мониторе с отрисовкой через Direct3D 11 и Desktop Duplication API.
- Автоматическое слежение за кареткой, мышью или сфокусированным контролом с подавлением «дрожания».
- Управление через системный трей и настраиваемый набор горячих клавиш по умолчанию (`Ctrl`+`Alt`+…).
- Блокировка попадания курсора на экран лупы с временным обходом (удержание `Ctrl` ≥ 0.5 сек открывает доступ на 5 секунд).
- Хранение пользовательских настроек в `%APPDATA%\ElectronicMagnifier\config.json`.

## Сборка
1. Установите на Windows 10/11 x64 инструменты разработки с поддержкой CMake и MSVC (Visual Studio 2022 или Build Tools). Необходима видеокарта с поддержкой DirectX 11.
2. Откройте x64 Native Tools Command Prompt и выполните:
   ```bash
   cmake -S . -B build -G "Visual Studio 17 2022" -A x64
   cmake --build build --config Release
   ```
3. Готовый бинарник `ElectronicMagnifier.exe` появится в `build/Release/`.

## Использование
1. Запустите `ElectronicMagnifier.exe`. По умолчанию основным источником считается главный монитор, окно лупы размещается на втором.
2. Доступные горячие клавиши (по умолчанию `Ctrl`+`Alt`):
   - `M` — включить/выключить окно лупы.
   - `+` / `-` — увеличить/уменьшить масштаб (1.0–12.0×).
   - `T` — переключить режим слежения (Auto → Caret → Mouse → Focus → Manual).
   - `S` — поменять местами рабочий и экран лупы.
   - `P` — заблокировать/разблокировать попадание курсора на экран лупы.
   - `O` — открыть подсказку по настройке.
3. Значок в трее позволяет:
   - Быстро включать/выключать лупу двойным кликом.
   - Открывать контекстное меню (ПКМ) с командами Toggle, Swap, Settings…, Exit.
4. Временный обход блокировки курсора: удерживайте `Ctrl` не менее 0.5 сек — курсор сможет перемещаться на монитор лупы в течение 5 секунд.

## Настройки
Файл `%APPDATA%\ElectronicMagnifier\config.json` создаётся автоматически. Пример:
```json
{
  "sourceMonitor": "\\\\.\\DISPLAY1",
  "magnifierMonitor": "\\\\.\\DISPLAY2",
  "zoom": 2.0,
  "trackingMode": "Auto",
  "blockCursor": true,
  "autoLaunch": true
}
```
Поля `sourceMonitor`/`magnifierMonitor` содержат идентификаторы мониторов (`EnumDisplayDevices`). `trackingMode` принимает значения `Auto`, `Caret`, `Mouse`, `Focus`, `Manual`.

## Ограничения и TODO
- Настройки в трее пока открывают подсказку; полноценный UI не реализован.
- При смене конфигурации мониторов или ошибке Desktop Duplication возможна кратковременная потеря кадра; в этом случае перезапустите приложение.
- Не реализованы профили и расширенные алгоритмы масштабирования (см. раздел 10 PRD).

